




%\newpage
%\pagenumbering{arabic}
MAYBE PUT SOME STUFF HERE ABOUT NUMERICAL ALGORITHMS LIKE RK4 EULAR STEP LEAPFROG AND DO ERROR GROWTH RATES AND COURANT


\section{Numerical Relativity}\label{nr:sec:nr} 
\subsection{Spacetime Foliation}
Einstein's equation is a classical field equation which governs the dynamics of physical objects and spacetime curvature. 
\begin{equation}\label{nr:eq:einstein}R_{\mu\nu} - \frac{1}{2} Rg_{\mu\nu} = \frac{8\pi G}{c^4}T_{\mu\nu}\end{equation}
The above version is fully covariant, agnostic of the definition of time, and many solutions are known analytically, for instance Black Hole geometries. When the system of interest becomes more complicated, such as the case of orbiting objects which will be discussed later, finding an analytic expression becomes impossible. For low energy dynamics, Newtonian theory, Post-Newtonian theory and perturbation theory can make more progress; however this report will focus on the highly nonlinear regime where Numerical relativity is truly the only hope to solve Einstein's equations. To do this it is common to split spacetime into 3+1 dimensions, evolving a 3 dimensional manifold (maybe with matter) on a computer along the final 4th dimension. To do this we need to define a suitable hypersurface $\Sigma \in \M$. This is usually done by demanding the hypersurface $\Sigma_t$ be the set of points $p \in \M$ where some scalar function $f:\M\mapsto \mathbb{R}$ satisfies $f(p)=t$. This hypersurface should be a Cauchy surface, intersecting all causal curves only once, or a partial Cauchy surface which intersects all causal curves at most once. Generally we will choose a partial Cauchy surface due to the finite memory of computers, however by picking certain compactified coordinates it is possible to use a Cauchy surface [REF]. A foliation $\mathcal{F}$ is then the union of a set of $\Sigma_t$ for some range of the parameter $t$,
\begin{equation}\mathcal{F} = \cup_t(\Sigma_t) \subseteq \M.\end{equation}
This means we should be careful to pick a parameter $t$ such that the foliation is not self intersecting for the parameter range that covers the region of $\M$ that we are interested in simulating. Fortunately the time coordinate in a suitable coordinate system works in all cases covered by this report; it also gives the physical interpretation of $\Sigma_t$ being an instance of time. Now we should define unit normal vector $n$ to $\Sigma_t$,
\begin{equation} n^\mu = -\frac{\nabla^\mu t}{\sqrt{|g_{\mu\nu}\nabla^\mu t \nabla^\nu t|}} \quad \& \quad  n_\mu = -\frac{dt_\mu}{\sqrt{|g_{\mu\nu}\nabla^\mu t \nabla^\nu t|}}.\end{equation}
For simplicity we define the lapse function $\alpha$ to be
\begin{equation}\alpha :=  \frac{1}{\sqrt{|g_{\mu\nu}\nabla^\mu t \nabla^\nu t|}}. \end{equation}
giving us $n_\mu = -\alpha \dd t_\mu$ as well as the normal evolution vector $m_\mu = \alpha n_\mu$. Defining two infinitessimaly close points $(p,q)\in(\Sigma_t,\Sigma_{t'})$ where $ q^\mu = p^\mu + m^\mu\delta t$ we see,
\begin{equation} t(q) = t(p^\mu +  m^\mu\delta t) = t(p) + \frac{\dd t}{\dd x^\mu}m^\mu\delta t = t(p) + \dd t_\mu m^\mu \delta t =  t(p) + \delta t,\end{equation} 
showing that $m^\mu$ points between neighbouring hypersurfaces; therefore when creating evolution equations we should care about Lie derivates along $m^\mu$, $\L_m$, rather than $\L_n$.



\subsection{The 3+1 Decomposition}
With the notion of a spacetime foliation we should define how to project tensors onto $\Sigma_t$; clearly scalars need no projecting. Splitting a vector $X^\mu \bs{e}_\mu = X^\mu_\| \bs{e}_\mu + X^\mu_\perp \bs{e}_\mu$ into components tangent or normal to $\Sigma_t$ we define the orthogonal projector $\perp^\mu_\nu$ and parallel projector $-n^\mu n_\nu$,
\begin{align}X^\mu_\| &= \left[ \delta^\mu_\nu + n^\mu n_\nu\right] X^\mu  = \perp^\mu_\nu X^\nu,\\
X^\mu_\perp &= -n^\mu n_\nu X^\nu .\end{align}
Considering scalars such as $\phi = w_\mu X^\mu$ or $\psi = T^{\mu\nu}w_\mu w_\nu$, and remembering scalars don't vary under projection, it is simple to show that any tensor $T$ can be projected by contracting a projection operator $\perp$ on any free index,
\begin{equation} {T_\|}^{ij ...}_{\;\;\;\;\;\;\;kl ...} = {\mathcal{T}}^{ij ...}_{\;\;\;\;\;\;\;kl ...} =\perp^{i}_{\mu}\perp^{j}_{\nu}\perp^{\rho}_{k}\perp^{\sigma}_{l}\cdot\cdot\cdot\, T^{\mu\nu ...}_{\;\;\;\;\;\;\;\;\;\;\rho\sigma ...}.\end{equation}
We can find the 3-metric $\gamma_{\mu\nu}$ of $\Sigma_t$ by projecting $g_{\mu\nu}$, 
\begin{equation} \label{nr:eq:gammaij}
\gamma_{ij} = \perp^\mu_i \perp^\nu_j g_{\mu\nu} = g_{\mu\nu} + n_\mu n_\nu\quad \rightarrow \quad \gamma^i_j = \perp^i_j,
\end{equation}
and we find it is equivalent to the projector $\perp$; this had to be the case as $\perp_{ij}\dd x^i\dd x^j$ gives the line element along $\Sigma_t$. With this machinery we can define the extrinsic curvature tensor $\K_{ij}$ representing curvature due to the choice of spacetime foliation; it could be nonzero for certain foliations of Minkowski space. It is not the same as the 3-Ricci tensor $\R_{ij}$ which is due to genuine spacetime curvature of $\M$ regardless of foliation. The extrinsic curvature tensor is defined the following way,
\begin{align} \label{nr:eq:Kij}\K_{ij}  &= \K_{ji}:= -\perp_i^\mu \perp_j^\nu \nabla_\mu n_\nu = -\perp_i^\mu \nabla_\mu n_j = -\nabla_i n_j - n_i a_j, \\
\K &= \K_i^i = -\bs{\nabla} \cdot \bs{n},\end{align}
where $a_i = \bs{n}\cdot\bs{\nabla} n_i $ is called the Eularian acceleration; it should be noted $\K_{ij}$ is symmetric. It can also be shown to take the following form,
\begin{equation}\label{nr:eq:lmL=alnK} \K_{ij} = -\frac{1}{2}\L_n \gamma_{ij} = -\frac{1}{2\alpha}\L_m \gamma_{ij},\end{equation}
which gives the intuitive explanation of $\K_{ij}$ being the rate of change of the 3-metric $\gamma_{ij}$ with respect to the foliation. 
The next object we should discuss is the projected covariant 3-derivative $\D_i$. This is the covariant derivative belonging to $\Sigma_t$ and hence it's arguments should be tensors belonging to $\Sigma_t$. This means we can define it as so,
\begin{align} {\mathcal{T}}^{ij ...}_{\;\;\;\;\;\;\;kl ...} &=\perp^{i}_{\mu}\perp^{j}_{\nu}\perp^{\rho}_{k}\perp^{\sigma}_{l}\cdot\cdot\cdot\, T^{\mu\nu ...}_{\;\;\;\;\;\;\;\;\;\;\rho\sigma ...},\\
  \D_m  {\mathcal{T}}^{ij ...}_{\;\;\;\;\;\;\;kl ...} :&=   \perp^\mu_m  \perp^{i}_{\mu}\perp^{j}_{\nu}\perp^{\rho}_{k}\perp^{\sigma}_{l}\cdot\cdot\cdot\, \nabla_\mu{\mathcal{T}}^{\mu\nu ...}_{\;\;\;\;\;\;\;\;\;\;\rho\sigma ...}.\end{align}
A simple example is the derivative of a vector $X^i \bs{e}_i \in \T(\Sigma_t)$,
\begin{gather} \D_i X^j = \partial_i X^j + \Upsilon^i_{\;\,jk}X^k,\\
\Upsilon^i_{\;\,jk} = \frac{1}{2}\gamma^{il}\left[ \partial_{j}\gamma_{lk} + \partial_{k}\gamma_{jk} -\partial_{l}\gamma_{jk} \right],\end{gather}
where $\Upsilon^i_{\;\,jk}$ is the Christoffel symbol of $\Sigma_t$. Another useful example is $a^\mu$ which can be equated to,
\begin{equation}\label{nr:eq:dlnalpha} a_\mu = \bs{n}\cdot \bs{\nabla} n_\mu = \D_\mu \ln \alpha = \frac{1}{\alpha}\D_\mu \alpha,\end{equation}
and allows us to evaluate the Lie derivative of the projector $\perp^i_j$,
\begin{align}
\L_m \perp^i_j &= \alpha n^k \nabla_k \perp^i_j + \perp^i_k \nabla_j \alpha n^k - \perp^k_j \nabla_k \alpha m^i,  \\
&= \alpha n^k \nabla_k \left[ n^i n_j\right]  + \alpha \nabla_j n^i - \left[ \alpha K_j^i + n^i \D_j \alpha\right], \\
&= 0.
\end{align}
The result $\L_m \perp^i_j=0$ is incredibly important, it tells us that the projector commutes with $\L_m$ and as a result any tensor $\bs{T}$ which when projected onto $\Sigma_t$, written $\bs{\T}$, satisfies
\begin{equation}  \label{nr:eq:LmT}\L_m {\mathcal{T}}^{ij ...}_{\;\;\;\;\;\;\;kl ...} =   \perp^{i}_{\mu}\perp^{j}_{\nu}\perp^{\rho}_{k}\perp^{\sigma}_{l}\L_m{{T}}^{\mu\nu ...}_{\;\;\;\;\;\;\;\;\;\;\rho\sigma ...}.\end{equation} 
In other words, evolving a projected tensor along integral curves of $m$ leaves the tensor parallel to $\Sigma_t$.



\subsection{Gauss, Codazzi and Ricci Equations}\label{nr:sec:gausscodazzi}
The projections of the 4-dimensional curvature tensors into a combination of 3-dimensional curvature tensors and $\bs{\mathcal{K}}$ is very useful as it captures all the degrees of freedom of the 4-dimensional Riemann tensor in terms of variables on $\Sigma_t$. This property is crucial when numerically simulating a single time slice $\Sigma_t$ as we only have access to variables on $\Sigma_t$.

\subsubsection{The Gauss Equations}
From the definition of the Riemann tensor in section~\ref{intro:sec:curvature} we know,
\begin{align} 
[\mathcal{D}_ i \mathcal{D}_ j -\mathcal{D}_ j \mathcal{D}_ i ]v^ k  = \mathcal{R}^ k _{\,\,\, m  i  j }v^ m  , \\
 [\nabla_\alpha\nabla_\beta-\nabla_\beta\nabla_\alpha]v^\gamma = {R}^\gamma_{\,\,\,\lambda \alpha\beta}v^\lambda  , 
 \end{align}
where the vector $v^ m = \perp^ m  _\rho v^\rho$ is tangent to $\Sigma_t$. Expanding the $\mathcal{D}$'s in terms of $\nabla$'s gives,
\begin{equation} \mathcal{D}_ i  \mathcal{D}_ j  v^ k  = \perp^\mu_ i  \perp_ j ^\sigma \perp^ k _\xi \nabla_\mu(\perp^\nu_\sigma \perp^\xi_\rho \nabla_\nu v^\rho),\end{equation}
and using the following properties; impotence of projections $\perp^ i _\mu \perp^\mu_ j  = \perp^ i _ j $, null projection of orthogonal vectors $\bs{\perp} (\bs{n}) =0$, metric compatibility $\nabla_\mu \perp^ i _ j  = n_ j \nabla_\mu n^ i  + n^ i  \nabla_\mu n_ j $ and Eq.~(\ref{nr:eq:Kij}) for $\K_{ij}$ we obtain the Gauss relation,
\begin{equation} \perp^\mu_ i  \perp^\nu_ j  \perp^ k _\rho \perp^\sigma_ l R^{\rho}_{\,\,\,\sigma\mu\nu} = \mathcal{R}^ k _{\,\,\, l i  j } + \mathcal{K}^ k _ i  \mathcal{K}_{ l j } - \mathcal{K}^ k _ j  \mathcal{K}_{ i l} . \end{equation}
Contracting over $ i , k $ above and relabelling indices we get the contracted Gauss relation,
\begin{equation} \perp^\mu_ i  \perp^\nu_ j  R_{\mu\nu} +  \gamma _{ i \mu}n^\nu\perp^\rho_ j  n^\sigma R^\mu_{\,\,\,\nu\rho\sigma} = \mathcal{R}_{ i  j } + \mathcal{K} \mathcal{K}_{ i  j } - \mathcal{K}^k_ j  \mathcal{K}_{ i k}.  \end{equation}
Contracting again and realising $R_{\mu\nu\rho\sigma}n^\mu n^\nu n^\rho n^\sigma=0$ from antisymmetry in indeces 0 and 1 or 2 and 3 in the Riemann tensor, gives the scalar Gauss equation,
\begin{equation}R + 2R_{\mu\nu}n^\mu n^\nu = \mathcal{R} + \mathcal{K}^2 - \mathcal{K}_{ij}\mathcal{K}^{ij}.\end{equation}

\subsubsection{The Codazzi Equations}
The Codazzi relations are derived from a different start point. Instead of projecting the Riemann tensor fully onto $\Sigma_t$ with projection operators $\bs{\perp}$ and a spacelike vector $\bs{v}$, it is now projected with a timelike vector $\bs{n}$,
\begin{equation}\label{nr:eq:Riem(n)}  [\nabla_\alpha\nabla_\beta-\nabla_\beta\nabla_\alpha]n^\gamma = {R}^\gamma_{\,\,\,\lambda \alpha\beta}n^\lambda ,\end{equation}
and again projecting to $\Sigma_t$ with three projection operators. The following relations are used 
\begin{align} 
\nabla_ j  n^ k  &= -\mathcal{K}^ k _{\,\,\, j } - a^ k  n_ j ,\\
 \perp^ i _\mu \perp^ j _\nu \perp^\rho_ k  \nabla_ i  \nabla_ j  n^ k  &= -\mathcal{D}_ i  \mathcal{K}^ k _{\,\,\, j } + a^ k  \mathcal{K}_{ i  j },
 \end{align}
which lead immediately to the Codazzi relation,
\begin{equation}\perp_ i ^\mu \perp_ j ^\nu \perp^ k _\rho n^\sigma R^\rho_{\,\,\,\sigma\mu\nu} =  \mathcal{D}_ j  \mathcal{K}^ k _{\,\,\, i } -\mathcal{D}_ i  \mathcal{K}^ k _{\,\,\, j },\end{equation}
and the contracted Codazzi relation,
\begin{equation}\perp^\mu_ i   n^\nu R_{\mu\nu} =  \mathcal{D}_ i  \mathcal{K} -\mathcal{D}_\mu \mathcal{K}^\mu_{\,\,\, i }.\end{equation}

\subsubsection{The Ricci Equation}
Finally we turn our attention to the Ricci equation, the projection of the Riemann tensor twice onto $\Sigma_t$ and twice contracting with $\bs{n}$. This is done by projecting Eq~(\ref{nr:eq:Riem(n)}) with two projectors $\bs{\perp}$ and one timelike $\bs{n}$. If we contract with $n^\gamma$ then the antisymmetry in the first two Riemann tensor indeces would identically gie to zero, therefore the unique choice (upto a minus sign) is to project with $n^\beta$,
\begin{align}
R_{\gamma\lambda\alpha\beta}n^\lambda n^\beta &=
 n^\beta \left[ \nabla_\alpha\nabla_\beta-\nabla_\beta\nabla_\alpha\right]n_\gamma, 
\end{align}
and project the remaining free indeces with $\bs{\perp}$ like,
\begin{align} \label{nr:eq:Rngng}
\perp_i^\gamma \perp^\alpha_j R_{\gamma\lambda\alpha\beta}n^\lambda n^\beta &=
 \perp_i^\gamma \perp^\alpha_j n^\beta \left[ \nabla_\alpha\nabla_\beta-\nabla_\beta\nabla_\alpha\right]n_\gamma. 
\end{align}
Rearanging Eqs.~(\ref{nr:eq:Kij}) and (\ref{nr:eq:dlnalpha}),
\begin{align} \nabla_\sigma n_\mu &= -\mathcal{K}_{\mu\sigma}-n_\sigma \mathcal{D}_\mu \ln(\alpha), 
\end{align}
which can be used to expand the right hand side of Eq.~(\ref{nr:eq:Rngng}),
\begin{align} \label{nr:eq:Rngng}
\perp_i^\gamma \perp^\alpha_j R_{\gamma\lambda\alpha\beta}n^\lambda n^\beta &=
 \perp_i^\gamma \perp^\alpha_j n^\beta \left[ -\nabla_\alpha\K_{\gamma\beta}+\nabla_\beta \K_{\gamma\alpha}\right]  \\ \nonumber&\quad+
 \perp_i^\gamma \perp^\alpha_j n^\beta \left[ -\nabla_\alpha (n_\beta \mathcal{D}_\gamma \ln(\alpha)) +\nabla_\beta (n_\alpha \mathcal{D}_\gamma \ln(\alpha))\right], \\
 &=
 \perp_i^\gamma \perp^\alpha_j n^\beta n^\sigma \nabla_\sigma \K_{\gamma\alpha} +  \perp^i_\gamma \perp^\alpha_j   \K_{\gamma\beta} \nabla_\alpha n^\beta  \\ \nonumber&\quad+
 \perp_i^\gamma \perp^\alpha_j n^\beta \left[ -n_\beta \nabla_\alpha ( \mathcal{D}_\gamma \ln(\alpha)) +n_\alpha \nabla_\beta \mathcal{D}_\gamma \ln(\alpha)  
 + ( \mathcal{D}_\gamma \ln(\alpha))  \nabla_\beta n_\alpha\right], \\ 
  &=
 \perp_i^\gamma \perp^\alpha_j n^\beta n^\sigma \nabla_\sigma \K_{\gamma\alpha} -   \K_{ik} \K^k_{\,\,\,j}  \\ \nonumber&\quad+
 \mathcal{D}_j \mathcal{D}_i \ln(\alpha) + \mathcal{D}_i \ln(\alpha) \mathcal{D}_j \ln(\alpha)   , \\ 
 &=
 \perp_i^\gamma \perp^\alpha_j n^\beta n^\sigma \nabla_\sigma \K_{\gamma\alpha} -   \K_{ik} \K^k_{\,\,\,j}  + \frac{1}{\alpha} \mathcal{D}_j \mathcal{D}_i \alpha   ,
\end{align}
where $\bs{n}^2 =-1$, $\perp_i^\mu n_\mu =0$, $\mathcal{D}_\alpha \ln \alpha = n^\beta \nabla_\beta n_\alpha$ from Eq.~(\ref{nr:eq:dlnalpha}) and $n^\beta \nabla_\alpha n_\beta =0$ were used. This expression can be simplified by calculating the Lie derivative of $\bs{\K}$,
\begin{align}
 \L_m \K_{ij}  &= \perp^\mu_i\perp^\nu_j\L_m \K_{\mu\nu} ,\\ &= \alpha\perp^\mu_i\perp^\nu_j\L_n \K_{\mu\nu} ,\\
 & =\alpha \perp^\mu_i\perp^\nu_j\left[ \alpha \bs{n}\cdot \bs{\nabla} \K_{\mu\nu} + 2 \K_{k(\nu}\nabla_{\mu)}n^k\right], \\
&= \alpha \perp^\mu_i\perp^\nu_j n^\sigma \nabla_\sigma \mathcal{K}_{\mu\nu} - 2\alpha\mathcal{K}_{ik}\mathcal{K}^k_{\,\,\,j},
 \end{align}
where the results $\L_m \bs{\K} = \alpha \L_n \bs{\K}$ from Eq.~(\ref{nr:eq:lmL=alnK}), $\mathcal{L}_m\mathcal{K}_{\alpha\beta} \in \Sigma_t$ from Eq.~(\ref{nr:eq:LmT}) and Eq.~(\ref{nr:eq:Kij}) were used. Putting everything together we arrive at the Ricci equation,
\begin{equation}\perp^\mu_{i} \perp^\nu_j n^\rho n^\sigma R_{\mu\rho\nu\sigma} = \frac{1}{\alpha}\mathcal{L}_m \mathcal{K}_{ij} +\frac{1}{\alpha}\mathcal{D}_j\mathcal{D}_i \alpha +\mathcal{K}_{ik}\mathcal{K}^k_{\,\,\,j}.  \label{nr:eq:riccieq}\end{equation}
This is the final contraction of the Riemann tensor that can be made with $\bs{\perp}$ and $\bs{n}$ as any projections with three or more contractions with $\bs{n}$ would identically give zero due to the symmetries of the Riemann tensor.


\subsection{Decomposition of Einstein's Equation} \label{nr:sec:einsteindecomp}
To evolve General Relativity numerically we must project the Einstein Equation into 3+1 dimensions. Relations between three and four dimensional geometric objects have been derived above and will be used to decompose the Einstein tensor $G_{\mu\nu} = R_{\mu\nu}-g_{\mu\nu}R/2$ from the left hand side of Eq.~(\ref{nr:eq:einstein}). The second component, for simulating non-vacumm spacetimes, is the 3+1 decomposition of the Stress tensor $T_{ab}$. We contract twice with $\bs{n}$, then once with $\bs{n}$ while projecting onto $\Sigma_t$ and finally twice projecting onto $\Sigma_t$ to get an energy, momentum and stress-like split,
\begin{align} \mathcal{E} &= \bs{T}(\bs{n},\bs{n}) = T_{\mu \nu}n^\mu n^\nu,\label{nr:eq:Tdecomp1}\\
 \S_i &= -\bs{T}(\bs{n},\cdot) = -\perp_i^\mu  n^\nu T_{\mu \nu}, \label{nr:eq:Tdecomp2}\\
\S_{ij} &= \perp^\mu _i\perp^\nu_j T_{\mu \nu},\label{nr:eq:Tdecomp3}\end{align}
and by construction,
\begin{equation} T_{\mu \nu} = \mathcal{E} n_\mu  n_\nu + \S_\mu  n_\nu + \S_\nu n_\mu  + \S_{\mu \nu}.\end{equation}
With this and the Gauss-Codazzi equations of section \ref{nr:sec:gausscodazzi} we can project the Einstein equation. Lets first look at the scalar equation,
\begin{equation} G_{\mu\nu}n^\mu n^\nu = R_{\mu\nu}n^\mu n^\nu + \frac{1}{2}R = 8\pi \E,\end{equation}
and equating the geometric terms to the scalar Gauss equation we get the Hamiltonian constraint, $\mathcal{H}=0$,
\begin{equation}\mathcal{H} = \K_{\mu\nu}\K^{\mu\nu}-\K^2 -\R + 16\pi \E  =0.\label{nr:eq:ham}\end{equation}
Now looking at the once projected part we see,
\begin{equation} \perp^\mu_i n^\nu G_{\mu\nu} =  \perp^\mu_i n^\nu R_{\mu\nu} = -8\pi\S_i,\end{equation}
and substituting the geometric terms for the contracted Codazzi relation we get the momentum constraint, $\mathcal{P}_i = 0$,
\begin{equation} \mathcal{P}_i = \D_i \K - \D_j\K^j_i  + 8\pi \S_i=0. \label{nr:eq:mom}\end{equation}
Finally, the space-space projection gives the 6 evolution PDE's. This time start with the trace reversed Einstein Equation
\begin{align} R_{\mu\nu} &= 8 \pi \left[T_{\mu\nu} - \frac{1}{2}Tg_{\mu\nu}\right],\\
\perp^\mu_i\perp^\nu_jR_{\mu\nu} &= 8 \pi \left[\S_{ij} - \frac{1}{2}(\S-\E)\gamma_{ij}\right],
\end{align}
where we used $T = \left[ \gamma^{\mu\nu} - n^\mu n^\nu\right]T_{\mu\nu} = \S-\E$. Project the Ricci tensor, we use the contracted Gauss equation but replace the term with $R^\mu_{\,\,\,\nu\rho\sigma}$ with the Ricci equation in Eq.~(\ref{nr:eq:riccieq}). Rearranging gives a normal evolution for the extrinsic curvature,
\begin{equation} \L_m \K_{ij} = -\D_j\D_i \alpha + \alpha \left[ \R_{ij} + \K\K_{ij} - 2\K^k_i\K_{kj} + 4\pi \left[ \gamma_{ij}\left[ \S-\E\right]-2\S_{ij}\right]\right].\end{equation}
Along with the definition of $\K_{ij}$ in Eq.~(\ref{nr:eq:lmL=alnK}), 
\begin{equation} \label{nr:eq:Lmgamma}
\L_m \gamma_{ij} = -2\alpha \K_{ij},
\end{equation}
this gives the normal evolution equations for $\gamma_{ij}$ and $\K_{ij}$. In $4$ or $n$ spacetime dimensions the normal evolution equations contain $6$ or $\frac{n^2-n}{2}$ differential equations, the Hamiltonian constraint is a single differential equation, the momentum constraint contains $3$ or $n-1$ differential equations and the Einstein equation contains $10$ or $\frac{n^2+n}{2}$ differential equations In four spacetime dimensions this corresponds to $6$ evolution equations and $4$ constraint equations over the surface $\Sigma_t$.

\subsection{Foliation Adapted Coordinates}

\begin{figure}[h!]
    \includegraphics[width=0.65\textwidth]{png/ADM_screeny.png}
\end{figure}
Picking coordinates in GR introduces a large gauge freedom which allows us to use a level set of the time coordinate $x^0=t$ to define our foliation hypersurfaces $\Sigma_t$. The other three coordinates $x^i$ for $i\in[1,2,3]$ can be used to span each hypersurface $\Sigma_t$ however we define. It is conventional to split the normal evolution vector $m^\mu$ into time $t^\mu$ and space parts $\beta^\mu$,
\begin{equation}\label{nr:eq:m1} m^\mu = t^\mu - \beta^\mu  = (\partial_0)^\mu - \beta^i (\partial_i)^\mu, \end{equation}
\begin{equation}\label{nr:eq:m2} m^\mu = \left( 1,-\beta^1,-\beta^2,-\beta^3\right). \end{equation}
We can view $t^\mu$ as the (not necessarily causal) worldline for a simulation gridpoint, hence we would like to evolve our PDE's along $t^\mu$ on a computer.  Equations~(\ref{nr:eq:m1}) and (\ref{nr:eq:m2}) along with the definition of $\bs{m}$, $\bs{m} = \alpha \bs{n}$,  specify $n^\mu$ and $n_\mu$,
\begin{align} 
n^\mu &=  \frac{1}{\alpha}\left( 1,-\beta^1,-\beta^2,-\beta^3\right),\\  
n_\mu &= -\alpha\left( 1,0,0,0\right).
\end{align}
The decomposed metric can be calculated, using the property that $\beta$ is tangent to $\Sigma_t$ and orthogonal to $m$,
\begin{align} 
g_{00} &= \bs{g}(\bs{\partial}_0,\bs{\partial}_0) = \bs{g}(\bs{m} + \beta^i \bs{\partial}_i,\bs{m} + \beta^j\bs{\partial}_j) = \bs{g}(\bs{m},\bs{m}) + \beta^i \beta_j \langle \bs{\partial}_i,{\bs{\mathrm{d}}} \bs{x}^j \rangle = -\alpha^2 + \beta^i \beta_i ,\\
 g_{0i} &= \bs{g} (\bs{\partial}_0,\bs{\partial}_i) =  \bs{g}(\bs{m} + \beta^j \bs{\partial}_j, \bs{\partial}_i) =   \beta^j\bs{g}( \bs{\partial}_j, \bs{\partial}_i) = \beta_i,\\
 g_{ij} &= \bs{g}(\bs{\partial}_i,\bs{\partial}_j) = \bs{\gamma}(\bs{\partial}_i,\bs{\partial}_j) = \gamma_{ij}.
 \end{align}
This is commonly called the $3+1$ ADM metric [REF] and $\alpha$, $\beta^i$ are referred to the lapse and shift vector in this context. The line element and metric are commonly written as,
\begin{align}
\dd s^2 &= -\alpha^2 \dd t^2 + \gamma_{ij}\left[\dd x^i + \beta^i \dd t\right]\left[\dd x^j + \beta^j \dd t\right],\\
 g_{\mu\nu} &= \begin{pmatrix} -\alpha^2 + \beta^i \beta_i & \beta_i \\ \beta_j & \gamma_{ij} \end{pmatrix},\label{nr:eq:admmetric}\\
  g^{\mu\nu} &= \frac{1}{\alpha^2}\begin{pmatrix} -1  & \beta^i \\ \beta^j & \alpha^2\gamma^{ij} - \beta^i \beta^j ,\end{pmatrix}
 \end{align}
and using Cramers rule for metric determinant,
\begin{equation} g^{00} = \frac{\det{\gamma_{ij}}}{\det{g_{\mu\nu}}},\end{equation}
we get the important relationship,
\begin{equation} \sqrt{-g} = \alpha \sqrt{\gamma} ,\label{nr:eq:gay}\end{equation}
where $g$ and $\gamma$ are the determinants of $g_{\mu\nu}$ and $\gamma_{ij}$ respectively.

\subsection{ADM Equations} \label{nr:sec:ADM}
Now that we have some coordinates suitable for the spacetime foliation we can find the Arnowitt-Deser-Misner (ADM) evolution equations for $\K_{ij}$ and $\gamma_{ij}$. First expand the Lie derivative $\L_m$ using
\begin{equation} t^{\mu} = (1,0,0,0) \rightarrow \L_t {{T}}^{\mu\nu ...}_{\;\;\;\;\;\;\;\rho\sigma ...} = \partial_t {{T}}^{\mu\nu ...}_{\;\;\;\;\;\;\;\rho\sigma ...}\end{equation}
\begin{equation} \L_m = \L_{t} - \L_\beta  = \partial_t - \L_\beta\end{equation}
and the ADM equations can be written by expanding the $\L_m$ in the normal evolution equations in section \ref{nr:sec:einsteindecomp} for $\bs{\K}$ and $\bs{\gamma}$. The ADM equations are,
\begin{align} 
\partial_t \K_{ij} &= \L_\beta \K_{ij}  -\D_j\D_i \alpha + \alpha \left[ \R_{ij} + \K\K_{ij} - 2\K^k_i\K_{kj} + 4\pi \left[ \gamma_{ij}\left[ \S-\E\right]-2\S_{ij}\right]\right],\\
\partial_t \gamma_{ij} &= \L_\beta \gamma_{ij} - 2\alpha\K_{ij}.\end{align}
Unfortunately, these PDE's turn out to be ill-posed [REF]; this means that the time evolution of these equations does not depens smoothly on the initial data. The ill-posedness of the ADM equations is resolved in the next section.


\subsection{BSSN} \label{nr:sec:bssn}
To tackle the ill-posedness of the ADM equations in section \ref{nr:sec:ADM} the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism [REF] is introduced. The first step in BSSN is to decompose the 3-metric into the conformal metric $\tilde{\gamma}_{ij}$ and the conformal factor $\chi$,
\begin{align} 
\tilde{\gamma}_{ij} &= \chi \gamma_{ij},\\
 \det{\tilde{\gamma}_{ij}} &= \tilde{\gamma} = \chi^3\gamma = 1,
\end{align}
with the above being the convention used in GRChombo described in [REF]. Other conventions include factors such as
$\tilde{\gamma}_{ij} = \psi^{-4}\gamma_{ij}$ or $e^{-\phi}\gamma_{ij}$.
 Along with this the extrinsic curvature $\K_{ij}$ is modified to be trace free,
\begin{equation} \tilde{A}_{ij} = \chi\left[ \K_{ij}-\frac{1}{3}\K\gamma_{ij}\right], \end{equation} so that $\tilde{A}_{ij}\gamma^{ij}=0$.
During an evolution the conditions $\trace{\tilde{A}_{ij}=0}$  and $\tilde{\gamma}=1$ are enforced which are observed to improve numerical stability; however it is unclear why beyond heuristic arguments. The definition of $\chi = \gamma^{-1/3}$ is good for black hole simulations where $\gamma\rightarrow\infty$ but $\chi \rightarrow 0$; for example the isotropic schwarzschild metric has 
\begin{align}
\gamma &= \left[ 1+ \frac{M}{2r}\right]^{12},\\
\chi &=\left[ \frac{r}{\frac{M}{2} + r}\right]^4.
\end{align} 

The next step is to introduce the conformal connection functions as auxiliary variables, 
\begin{align} \tilde{\Upsilon}^i &= \tilde{\gamma}^{jk}\tilde{\Upsilon}^i_{\,\;jk} = -\partial_i \tilde{\gamma}^{ij},\\
 \tilde{\Upsilon}^i_{\,\;jk} &= \frac{1}{2}\tilde{\gamma}^{il}\left[ \partial_j \tilde{\gamma}_{kl} + \partial_k \tilde{\gamma}_{lj} - \partial_l \tilde{\gamma}_{jk}\right] = \Upsilon^i_{\;\,jk} + \left[ \delta^i_j \partial_k + \delta^i_k \partial_j - \gamma^{il}\gamma_{jk}\partial_l\right] \ln \sqrt{\chi}.\end{align}
This reduces the set of vacuum evolution variables to $\{\chi,\tilde{\gamma}_{ij},\K,\tilde{\A}_{ij},\tilde{\Upsilon}^i \}$. It is conventional to use $-\partial_i \tilde{\gamma}^{ij}$ to evaluate the conformal connection coefficients when they appear in the RHS of an equation, but $\partial_j \tilde{\Upsilon}^i$ is calculated by differentiating the evolution variable $\tilde{\Upsilon}^i$. One final necessity, not included in the CCZ4 formulation discussed later, is to add multiples of the constraint equations (in section \ref{nr:sec:einsteindecomp}) to the evolution equations to change the characteristic matrix and improve stability. 

The BSSN formalism is not the only way to find a well-posed set of evolution equations for general relativity. Another strongly hyperbolic formalism is the generalised harmonic gauge \cite{harmonic} with, 
\begin{equation}\Box x^\mu = H^\mu,\end{equation}
for some functions $H^\mu$.


\subsection{Z4 Formalism}
The Z4 formalism \cite{z4} generalises the Einstein equation to include an unphysical field $Z_\mu$, along with damping terms parameterised by $\kappa_1$, $\kappa_2$, 
\begin{equation}\label{nr:eq:z4einstein} R_{\mu\nu} + \nabla_\mu Z_\nu + \nabla_\nu Z_\mu - \kappa_1\left[ n_\mu Z_\nu + n_\nu Z_\mu - [1+\kappa_2]g_{\mu\nu}n^\alpha Z_\alpha\right] = 8\pi G \left[T_{\mu\nu}- \frac{1}{2}Tg_{\mu\nu} \right].\end{equation}
Of course regular General Relativity is returned setting $Z_\mu=0$. It is shown in [] that achieving $Z_\mu=0$ whilst dynamically evolving $Z_\mu$  is equivalent to solving the constraints. $Z_\mu$ is subjected to a wave equation, transporting constraint violation off the computational domain. It can be shown that the system is driven to $Z_\mu =0$ for $k_1>0$ and $k_2<-1$. It is much cheaper to evolve the variables $Z_\mu$, driven to zero, than do perform four elliptic solves for the constraints $\{\mathcal{H},\M^i\}$ on each timestep. 

\subsection{CCZ4} \label{nr:sec:ccz4}
Joining BSSN with Z4 gives the CCZ4 formalism. The additional modifications,
\begin{align} \Theta &= -n\cdot Z  = -\alpha Z^0,\\
\hat{\Upsilon}^i &= \tilde{\Upsilon}^i + \frac{2\gamma^{ij}Z_j}{\chi},\end{align}
are made, leaving us with the following set of vacuum evolution variables $\{\chi, \tilde{\gamma}_{ij},\K,\tilde{\A}_{ij},\hat{\Upsilon}^i,\Theta \}$. Notably the pair of variables $\R_{ij} + \D_{(i}Z_{j)}$, and traced version $\R + \bs{\D}\cdot \bs{Z}$, always appear together; separately they ruin strong hyperbolically but together they do not. The evolution equations can now be found in the CCZ4 scheme by doing a 3+1 decomposition of the Z4 modified Einstein equation in Eq.~(\ref{nr:eq:z4einstein}) and following the BSSN formalism. To illustrate this, the equation of motion for $\chi$ is derived. Using Eqs.~(\ref{intro:eq:mdmmdm}) and (\ref{nr:eq:Lmgamma}) with $\chi^{-3}=\gamma$,
\begin{align}
\L_m {\gamma} = \gamma \gamma^{ij} \L_m \gamma_{ij} = -2 \gamma \alpha \gamma^{ij} \K_{ij} = -2\gamma \alpha \K.
\end{align}
This can be used to simplify the Lie derivative of $\chi$,
\begin{align}
\L_m \chi &= \L_{\partial_t}\chi - \L_\beta \chi,\\
 &= (\partial_t)^i \partial_i \chi + \omega \chi \partial_i (\partial_t)^i - \beta^i \partial_i \chi - \omega \chi \partial_i \beta^i ,\\
 &= \partial_t \chi - \beta^i \partial_i \chi +\frac{2}{3} \chi\partial_i \beta^i ,\\
\L_m \chi &= \L_m \gamma^{-\frac{1}{3}}  ,\\
&=-\frac{1}{3}\gamma^{-\frac{4}{3}}\L_m \gamma  ,\\
&=\frac{2}{3}\gamma^{-\frac{1}{3}} \alpha \K ,\\
&=\frac{2}{3}\chi\gamma \alpha \K ,
\end{align}
where $\omega=-2/3$ is the weight of $\chi$. The equation for the lie derivative for a tensor density $\bs{\T}$ of weight $w$,
\begin{equation} 
\L_\xi \bs{\mathcal{T}} =  \widetilde{\L}_\xi \bs{\T} + w \bs{\T}  \partial_\mu \xi^\mu ,
\end{equation}
given in Eq.~\ref{intro:eq:Ltensordensity2} was used where $ \widetilde{\L}_X$ represents the differential operator that is equivalent to $\L_X$ if it didn't act on a tensor density.
Finally, rearanging gives the equation of motion for $\chi$,
\begin{equation}
\partial_t \chi =  \beta^k \partial_k \chi + \frac{2\chi}{3} \left[\alpha \K - \partial_k \beta^k \right].
\end{equation}
A similar process returns the CCZ4 equations but care should be taken to include the Z4 terms where they are needed. The complete list of CCZ4 equations used in simulations with GRChombo [REF] are given below.
\begin{align} \partial_t \chi &=  \beta^k \partial_k \chi + \frac{2\chi}{3} \left[\alpha \K - \partial_k \beta^k \right]\\
\partial_t\tilde{\gamma}_{ij} &=  \beta^k\partial_k\tilde{\gamma}_{ij}  + \tilde{\gamma}_{kj}\partial_i \beta^k + \tilde{\gamma}_{ik}\partial_j\beta^k - \frac{2}{3}\tilde{\gamma}_{ij} \partial_k \beta^k - 2\alpha\tilde{\A}_{ij}\\
\partial_t\K &=  \beta^k\partial_k\K + \alpha\left[ \R + 2\bs{\D}\cdot \bs{Z} + \K\left[ \K-2\Theta\right]\right] - 3\alpha \kappa_1\left[ 1+\kappa_2\right]\Theta \nonumber\\
&-\chi\tilde{\gamma}^{kl}\D_k\D_l\alpha + 4\pi G\alpha\left[ \S - 3\E\right] \\
\partial_t\tilde{\A}_{ij} &=  \beta^k \partial_k \tilde{\A}_{ij}+\chi\left[\alpha\left[\R_{ij} + 2\D_{(i}Z_{j)}-8\pi G \S_{ij} \right] -\D_i\D_j\alpha \right]^{TF}\nonumber\\
& +\tilde{\A}_{ij}\left[ \alpha\left[ \K-2\Theta\right]-\frac{2}{3}\K^2\right] + 2\tilde{\A}_{k(i}\partial_{j)}\beta^k -2\alpha\tilde{\gamma}^{kl}\tilde{\A}_{ik}\tilde{\A}_{lj}\\
\partial_t\Theta &= \beta^k\partial_k \Theta + \frac{1}{2}\alpha\left[ \R + 2\bs{\D}\cdot \bs{Z} - \tilde{\A}_{kl} \tilde{\A}^{kl} + \frac{2}{3}\K^2 - 2\Theta\K\right] -\kappa_1\alpha\Theta\left[ 2+\kappa_2\right] - Z^k\partial_k\alpha - 8\pi G \alpha \E \\
\partial_t\hat{\Upsilon}^i &=  \beta^k \partial_k \hat{\Upsilon}^i + \frac{2}{3}\left[ \partial_k \beta^k \left[ \tilde{\Upsilon}^i+2\kappa_3 \frac{Z^{i}}{\chi}\right]-2\alpha\K\frac{Z^j}{\chi}\right]-2\alpha\kappa_1\frac{Z^i}{\chi}\nonumber \\
& + 2\tilde{\gamma}^{ij}\left[ \alpha\partial_j\Theta -\Theta \partial_j\alpha \right] -2\tilde{\A}^{ij}\partial_j\alpha - \alpha\left[ \frac{4}{3}\tilde{\gamma}^{ij}\partial_j\K + 3\tilde{\A}^{ij}\frac{\partial_j \chi}{\chi}\right]\nonumber\\
& -\left[ \tilde{\Upsilon}^j + 2\kappa_3 \frac{Z^j}{\chi}\right]\partial_j \beta^i + 2\alpha \tilde{\Upsilon}^i_{\,\,\,jk}\tilde{\A}^{jk} + \tilde{\gamma}^{jk}\partial_j\partial_k \beta^i + \frac{1}{3} \tilde{\gamma}^{ij}\partial_k \partial_j \beta^k - 16\pi G \alpha \tilde{\gamma}^{ij}\S_j \\
\partial_t \vp &= \beta^k\partial_k \vp - \alpha\Pi \label{nr:eq:ccz4kg1}\\
\partial_t \Pi &= \beta^k\partial_k\Pi -\chi \tilde{\gamma}^{ij}\partial_i \vp \partial_j \alpha + \alpha \left[ \chi \tilde{\Upsilon}^k\partial_k \vp+\frac{1}{2} \tilde{\gamma}^{lk}\partial_k\chi\partial_l\vp  - \chi \tilde{\gamma}^{ij}\partial_i \partial_j \vp + \K \Pi + V' \vp \right]\label{nr:eq:ccz4kg2}\end{align}
Note that Eqs.~(\ref{nr:eq:ccz4kg1}) and (\ref{nr:eq:ccz4kg2}) are for the 3+1 Klein-Gordon equation which will be derived later in section \ref{boson:sec:3+1kgeqn}. Also to be noted, in the CCZ4 equations there is an additional parameter $\kappa_3$ premultiplying terms in the evolution of $\hat{\Upsilon}^i$ which experimentally were found to ruin numerical stability for black hole simulations []. Setting $\kappa_3<1$ stabilises the simulation but at the cost of covariance. Later on it was realised that setting $\kappa_3=1$ and $\alpha\kappa_1\rightarrow\kappa_1$ retains covariance as well as numerical stability [REF].



The CCZ4 scheme proves useful in my simulations for a few reason. Firstly, any initial data that does not satisfy the constraints will not do so along evolution either when using BSSN. Given that superposition of solutions in GR does not generally give a new solution, but does approximate one for separated compact objects, all the simulated binaries considered in the report will have non constraint satisfying initial data. The use of the CCZ4 scheme will also help simulations satisfy the constraints even if they initially satisfy them; one reason being that finite resolution imposes some small deviation from the continuum solution. More importantly, the use of adaptive mesh refinement AMR introduces large interpolation errors into the simulation at the boundary of the different grid resolution levels. Finally, the Sommerfeld boundary conditions used are inexact in GR and will introduce small errors at the boundary that ruin constraint satisfaction. In all above cases, the CCZ4 system forces the evolution towards constraint satisfaction, despite the numerical errors and approximations.


\subsection{Gauge Conditions}\label{nr:sec:gaugeconditions}
In GR, the lapse $\alpha$ and shift $\beta^i$ are freely specifiable being gauge variables, however they must be chosen carefully along with a suitable initial Cauchy surface $\Sigma_{t_0}$ for sensible foliations and numerical accuracy. Figure~\ref{nr:fig:eddington-finkelstein} (left) shows how a poor initial Cauchy surface could extend to the singularity for ingoing Eddington-Finkelstein coordinates; likely causing a simulation crash. In this work $\Sigma_{t_0}$ is chosen to be in the isotropic gauge as in figure~\ref{nr:fig:isotropic} (right); not only does this allow trivial swapping between spherical polar and Cartesian (used in the simulation) coordinates but also provides an initial Cauchy surface free of singularities and easy to compute. For a poor choice of lapse function, even a well chosen $\Sigma_{t_0}$ can advance to the singularity in finite simulation time.
%   \begin{figure}[h]
%   \caption{Penrose Diagrams, $\Sigma_{t_0}$ dashed, Left: Ingoing Eddington-Finkelstein Coordinates, Right: Isotropic Coordinates.}
%   \centering
%   \subfloat{\includegraphics[width=0.43\textwidth]{schwarzschild2.png}\label{boson:fig:f1}} \label{nr:fig:eddington-finkelstein}
%   \hfill
%   \subfloat{\includegraphics[width=0.5\textwidth]{schwarzschild.png}\label{boson:fig:f2}} \label{nr:fig:isotropic}
% \end{figure}

  \begin{figure}[h]
  \caption{Penrose Diagrams, $\Sigma_{t_0}$ dashed, Left: Ingoing Eddington-Finkelstein Coordinates, Right: Isotropic Coordinates.}
  \centering
  \subfloat{\includegraphics[width=0.43\textwidth]{png/sc_penrose.png}\label{boson:fig:f1}} \label{nr:fig:eddington-finkelstein}
  \hfill
  \subfloat{\includegraphics[width=0.5\textwidth]{png/iso_penrose.png}\label{boson:fig:f2}} \label{nr:fig:isotropic}
\end{figure}

\subsubsection{Lapse Gauge Conditions}

The simplest lapse choice would be to enforce $\alpha=1$, called geodesic slicing, with the hypersurface following intergral curves of $n^\mu$; given that geodesics can converge this can lead to hypersurface self-intersection which breaks the definition of a Cauchy surface and the simulation will likely fail. Another problem is that a black hole singularity can be reached in finite simulation time. Geodesic slicing can be modified to the maximal slicing condition which keeps the volume element $\sqrt{-g}$ constant along geodesics. This means as $\gamma\rightarrow\infty$ nearing a singularity $\alpha\rightarrow0$ from Eq.~(\ref{nr:eq:gay}), causing the hypersurface to advance more slowly before a singularity is reached. This property is called singularity avoiding and is crucial for numerical stability (unless using excision?). Maximal slicing can be implemented by forcing $\mathcal{K} = \partial_t \K = 0$ $\forall t$ which requires a slow elliptic solve for $\alpha$ at each timestep. Instead $\alpha$ is promoted to an evolution variable and is evolved along with every other simulation variable. To do this we can pick an algebraic slicing condition of the Bona-Masso type,
\begin{equation}\L_m \alpha = \partial_t \alpha - \beta^i \partial_i \alpha = -\alpha^2 f(\alpha)\K. \end{equation}
This is used with $f = 2\alpha^{-1}$ in GRChombo [REF] giving,
\begin{equation}\L_m \alpha = -2\alpha \K, \end{equation}
and using gaussian normal coordinates $\beta^i=0$ it reduces to, 
\begin{equation} \alpha = 1+ \ln \gamma,\end{equation}
which is called 1+log slicing; this is very common in Numerical Relativity codes. In practice 1+log slicing is strongly singularity avoiding reaching $\alpha=0$ before the singularity. This is modified in the CCZ4 scheme to, 
\begin{equation}\partial_t \alpha = -2\alpha\left[ \K-2\Theta\right] + \beta^i \partial_i \alpha,\end{equation}
which is very similar to before; it should be noted that the advection term is important for black hole simulations.

\begin{figure}[h!]
    \includegraphics[width=0.9\textwidth]{svg/foliation.png} 
      \caption{Diagram showing the time evolution of a hypersurface using a singularity avoiding lapse gauge condition. The vertical squiggled line represents a physical singularty that is formed at some point in spacetime, potentially from the collapse of matter to a black hole.} \label{nr:fig:singularity_avoiding}
\end{figure}


\subsubsection{Shift Gauge Conditions}

So far the shift vector $\beta^i$ has been ignored, the simplest choice for it would be $\beta^i=0$ as in 1+log slicing. Using 1+log slicing causes great stretching and shearing of $\Sigma_t$ in the neghbourhood of a singularity as in Fig.~(\ref{nr:fig:singularity_avoiding}); the effect of this is that neighbouring gridpoints have large differences in field values leading to inaccurate and unstable evolutions. Another negative side effect is that the computational domain can fall inside an event horizon in black hole simulations. To counteract this we want to pick a shift vector that minimises hypersurface shear $\sigma_{ij}$ which can be defined as [REF] [ref 1977 smarr and york], 
\begin{equation} \sigma_{ij}:= \perp^\mu_i \perp^\nu_j \left[\nabla_{(\mu} n_{\nu)}-\frac{1}{3}\gamma^{ab}\nabla_{(a} n_{b)} \gamma_{\mu\nu}\right], \end{equation}
where $\sigma_{ij}$ is tracefree corresponding to shearing rather than inflation or expansion. Minimising the total shear $\Sigma$,
\begin{equation} \Sigma = \int \sigma_{ij}\sigma^{ij}\sqrt{\gamma}\,\dd x^3,\end{equation}
with respect to $\beta^i$ leads to an elliptic PDE to be solved for each $\beta^i$ at each time step that minimises shear, 
\begin{equation} \delta \Sigma = 0 \rightarrow \D_i\sigma^{ij}=0.\end{equation}
This is known as the minimal shift condition. As before, promoting $\beta^i$ to be evolution variables is computationally cheaper that solving a set of PDE's at each time step. A very common choice is to promote the elliptic PDE for $\beta^i$ into a hyperbolic equation via introducing a $\partial_t^2\beta^i$ term and an artificial damping term parameterised by $\eta$. This becomes a damped wave equation and is supposed to transport away any part of $\beta^i$ which does not satisfy $\D_i \sigma^{ij}=0$. This requires Sommerfeld (outgoing wave) boundary conditions as in [REF]. In GRChombo the standard gamma driver shift condition is used,
\begin{align} \partial_t \beta^i &= FB^i,\\
 \partial_t B^i &= \partial_t \tilde{\Gamma}^i - \eta B^i,\end{align}
where $F=3/4$ and $\eta=1$ are used.

TALK ABOUT MOVING PUNCTURE GAUGE AND CHI CLOOR OF CHI TEN MINUS 6 (OR IS IT 5?)


\subsection{stuff}
FIX THE FUCKING HAND REFERNECES!


